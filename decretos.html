<!-- decretos.html -->
<style>
  /* ===== Escopo da página de Decretos ===== */
  .dec-wrap { display: grid; gap: 1rem; }
  .dec-head { display: flex; align-items: end; justify-content: space-between; flex-wrap: wrap; gap: .75rem; }
  .dec-lead { color: var(--muted); max-width: 75ch; line-height: 1.7; }

  .dec-filters {
    display: grid;
    grid-template-columns: 1.2fr .8fr .8fr .8fr auto;
    gap: .6rem;
    background: #fff;
    border: 1px solid #e6edf8;
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: .8rem;
  }
  .dec-filters input[type="search"],
  .dec-filters select {
    width: 100%;
    padding: .65rem .8rem;
    border: 1px solid var(--steel);
    border-radius: 8px;
    font: inherit;
    background: #fff;
  }
  .dec-filters .dec-actions {
    display: flex; gap: .5rem; align-items: center; justify-content: flex-end;
  }
  .dec-btn {
    border: 1px solid #dbe2f0; background: #0a489b; color: #fff;
    border-radius: 8px; padding: .65rem .9rem; cursor: pointer; font-weight: 600;
  }
  .dec-btn.secondary { background: #fff; color: #0a489b; }
  .dec-btn:disabled { opacity: .6; cursor: not-allowed; }

  /* Lista de resultados */
  .dec-list { display: grid; gap: .6rem; margin-top: .25rem; }
  .dec-item {
    background: #fff; border: 1px solid #e6edf8; border-radius: 12px; box-shadow: var(--shadow);
    padding: .85rem .95rem; display: grid; gap: .45rem;
  }
  .dec-top {
    display: flex; align-items: center; justify-content: space-between; gap: .75rem; flex-wrap: wrap;
  }
  .dec-id {
    display: inline-flex; align-items: center; gap: .5rem; font-weight: 700;
  }
  .dec-id .dec-badge {
    display: inline-grid; place-items: center; width: 26px; height: 26px;
    border-radius: 6px; background: #f7fbff; border: 1px solid #e6edf8;
    font-size: .85rem;
  }
  .dec-meta { color: var(--muted); font-size: .92rem; }
  .dec-title { font-size: 1.02rem; margin: 0; }
  .dec-actions-row { display: flex; gap: .5rem; flex-wrap: wrap; }
  .dec-link {
    display: inline-flex; align-items: center; gap: .4rem;
    padding: .4rem .6rem; border: 1px solid #dbe2f0; border-radius: 8px;
    text-decoration: none; color: #0a489b; background: #fff;
  }
  .dec-link:hover { background: #f7fbff; }

  details.dec-details { background: #f8fafc; border: 1px solid #e6edf8; border-radius: 10px; padding: .6rem .7rem; }
  details.dec-details summary { cursor: pointer; font-weight: 600; color: #0a489b; }
  .dec-empty {
    background: #fff; border: 1px solid #e6edf8; border-radius: 12px; box-shadow: var(--shadow);
    padding: 1rem; color: var(--muted);
  }

  /* Paginação */
  .dec-pager {
    display: flex; align-items: center; justify-content: space-between; gap: .75rem; flex-wrap: wrap;
    margin-top: .25rem;
  }
  .dec-page-btns { display: inline-flex; gap: .4rem; }
  .dec-page-btn {
    border: 1px solid #dbe2f0; background: #fff; color: #0a489b; border-radius: 8px;
    padding: .55rem .75rem; cursor: pointer; font-weight: 600;
  }
  .dec-page-btn[disabled] { opacity: .5; cursor: not-allowed; }
  .dec-count { color: var(--muted); font-size: .92rem; }

  /* Segurança de overflow */
  .dec-wrap, .dec-wrap * { overflow-wrap: anywhere; word-break: break-word; }

  @media (max-width: 1024px) {
    .dec-filters { grid-template-columns: 1fr 1fr 1fr 1fr auto; }
  }
  @media (max-width: 720px) {
    .dec-filters { grid-template-columns: 1fr 1fr; }
    .dec-filters .dec-actions { grid-column: 1 / -1; justify-content: flex-start; }
  }
</style>

<h1>Decretos</h1>

<div class="dec-wrap" aria-live="polite">
  <div class="dec-head">
    <p class="dec-lead">
      Consulte decretos, portarias e resoluções publicados pelo Governo do Estado.
      Use a busca, filtre por ano e tipo, e baixe o PDF oficial.
    </p>
  </div>

  <!-- Filtros -->
  <form class="dec-filters" id="decFilters" autocomplete="off">
    <input type="search" id="decQ" placeholder="Buscar por número, assunto ou palavra-chave" aria-label="Buscar decretos" />
    <select id="decAno" aria-label="Filtrar por ano">
      <option value="">Ano (todos)</option>
      <!-- opções são populadas via script -->
    </select>
    <select id="decTipo" aria-label="Filtrar por tipo">
      <option value="">Tipo (todos)</option>
      <option>Decreto</option>
      <option>Portaria</option>
      <option>Resolução</option>
    </select>
    <select id="decSort" aria-label="Ordenar">
      <option value="data_desc">Mais recentes</option>
      <option value="data_asc">Mais antigos</option>
      <option value="num_desc">Número decrescente</option>
      <option value="num_asc">Número crescente</option>
    </select>
    <div class="dec-actions">
      <button type="submit" class="dec-btn">Aplicar</button>
      <button type="button" class="dec-btn secondary" id="decClear">Limpar</button>
    </div>
  </form>

  <!-- Lista -->
  <div id="decList" class="dec-list" role="list"></div>

  <!-- Paginação -->
  <div class="dec-pager">
    <div class="dec-count" id="decCount">0 resultados</div>
    <div class="dec-page-btns">
      <button type="button" class="dec-page-btn" id="decPrev">‹ Anterior</button>
      <button type="button" class="dec-page-btn" id="decNext">Próxima ›</button>
    </div>
  </div>
</div>

<script>
(function(){
  // ===== Dados de EXEMPLO (substitua pelos seus) =====
  // Campos: id, tipo, numero, data (YYYY-MM-DD), ementa, assunto, pdf
  const decDATA = [
    {
      id: '2025-045',
      tipo: 'Decreto',
      numero: 45,
      data: '2025-08-28',
      assunto: 'Institui o Programa de Digitalização de Processos Administrativos no âmbito do Executivo.',
      ementa: 'Institui o Programa de Digitalização, define diretrizes e dá outras providências.',
      pdf: 'https://example.com/decretos/2025/decreto-45-2025.pdf'
    },
    {
      id: '2025-012',
      tipo: 'Portaria',
      numero: 12,
      data: '2025-06-10',
      assunto: 'Estabelece cronograma de capacitações para servidores estaduais.',
      ementa: 'Dispõe sobre o calendário de capacitações e critérios de participação.',
      pdf: 'https://example.com/portarias/2025/portaria-12-2025.pdf'
    },
    {
      id: '2024-301',
      tipo: 'Decreto',
      numero: 301,
      data: '2024-12-19',
      assunto: 'Regulamenta procedimentos de compras públicas com prioridade para MPEs.',
      ementa: 'Regulamenta o tratamento favorecido às Micro e Pequenas Empresas nas contratações públicas.',
      pdf: 'https://example.com/decretos/2024/decreto-301-2024.pdf'
    },
    {
      id: '2024-077',
      tipo: 'Resolução',
      numero: 77,
      data: '2024-05-08',
      assunto: 'Atualiza a política de segurança da informação no âmbito do Estado.',
      ementa: 'Altera dispositivos da política de segurança da informação e dá outras providências.',
      pdf: 'https://example.com/resolucoes/2024/resolucao-77-2024.pdf'
    },
    {
      id: '2023-010',
      tipo: 'Portaria',
      numero: 10,
      data: '2023-03-02',
      assunto: 'Define procedimentos para cadastro de fornecedores no sistema estadual.',
      ementa: 'Estabelece procedimentos e prazos para cadastro e atualização de fornecedores.',
      pdf: 'https://example.com/portarias/2023/portaria-10-2023.pdf'
    }
  ];

  // ===== Estado e referências =====
  const state = {
    q: '', ano: '', tipo: '', sort: 'data_desc',
    page: 1, perPage: 10, // ajuste aqui o tamanho da página
    view: [] // resultado após filtro/ordenação
  };

  const $list = document.getElementById('decList');
  const $count = document.getElementById('decCount');
  const $prev = document.getElementById('decPrev');
  const $next = document.getElementById('decNext');

  const $filters = document.getElementById('decFilters');
  const $q = document.getElementById('decQ');
  const $ano = document.getElementById('decAno');
  const $tipo = document.getElementById('decTipo');
  const $sort = document.getElementById('decSort');
  const $clear = document.getElementById('decClear');

  // ===== Utilidades =====
  const fmtDate = (iso) => {
    if (!iso) return '';
    const d = new Date(iso + 'T12:00:00'); // evita timezone
    return d.toLocaleDateString('pt-BR');
  };
  const getAno = (iso) => (iso || '').slice(0,4);

  // Preenche combo de anos
  (function fillYears(){
    const anos = Array.from(new Set(decDATA.map(d => getAno(d.data)).filter(Boolean))).sort((a,b)=>b-a);
    $ano.innerHTML = '<option value="">Ano (todos)</option>' + anos.map(a=>`<option value="${a}">${a}</option>`).join('');
    // tenta ler querystring ?ano=YYYY
    const usp = new URLSearchParams(location.search);
    const pAno = usp.get('ano'); if (pAno && anos.includes(pAno)) { $ano.value = pAno; state.ano = pAno; }
  })();

  // ===== Filtro + ordenação =====
  function apply(){
    const q = (state.q || '').trim().toLowerCase();
    let arr = decDATA.slice();

    if (q) {
      arr = arr.filter(d =>
        String(d.numero).includes(q) ||
        (d.assunto || '').toLowerCase().includes(q) ||
        (d.ementa || '').toLowerCase().includes(q) ||
        (d.tipo || '').toLowerCase().includes(q)
      );
    }
    if (state.ano) arr = arr.filter(d => getAno(d.data) === state.ano);
    if (state.tipo) arr = arr.filter(d => (d.tipo || '') === state.tipo);

    switch (state.sort) {
      case 'data_asc':  arr.sort((a,b)=> a.data.localeCompare(b.data)); break;
      case 'data_desc': arr.sort((a,b)=> b.data.localeCompare(a.data)); break;
      case 'num_asc':   arr.sort((a,b)=> (a.numero||0) - (b.numero||0)); break;
      case 'num_desc':  arr.sort((a,b)=> (b.numero||0) - (a.numero||0)); break;
    }

    state.view = arr;
    state.page = 1;
    render();
  }

  // ===== Renderização =====
  function render(){
    const total = state.view.length;
    const start = (state.page - 1) * state.perPage;
    const end = start + state.perPage;
    const pageItems = state.view.slice(start, end);

    // Count
    $count.textContent = total
      ? `${total} resultado${total>1?'s':''} — página ${state.page} de ${Math.max(1, Math.ceil(total/state.perPage))}`
      : 'Nenhum resultado';

    // Pager
    $prev.disabled = state.page <= 1;
    $next.disabled = end >= total;

    // List
    if (!pageItems.length) {
      $list.innerHTML = `<div class="dec-empty">Tente alterar os filtros ou limpar a busca.</div>`;
      return;
    }

    $list.innerHTML = pageItems.map(item => {
      const ano = getAno(item.data);
      return `
        <article class="dec-item" role="listitem">
          <div class="dec-top">
            <div class="dec-id">
              <span class="dec-badge">${(item.tipo||'?').substring(0,1)}</span>
              ${item.tipo || '—'} nº ${item.numero || '—'}/${ano || '--'}
            </div>
            <div class="dec-meta">${fmtDate(item.data)}</div>
          </div>

          <h3 class="dec-title">${item.assunto || ''}</h3>

          <div class="dec-actions-row">
            ${item.pdf ? `<a class="dec-link" href="${item.pdf}" target="_blank" rel="noopener" aria-label="Abrir PDF do ${item.tipo} nº ${item.numero}">📄 PDF</a>` : ''}
            <details class="dec-details">
              <summary>Ver ementa</summary>
              <div style="margin-top:.4rem">${item.ementa || 'Sem ementa.'}</div>
            </details>
          </div>
        </article>
      `;
    }).join('');
  }

  // ===== Eventos =====
  $filters.addEventListener('submit', (e)=>{
    e.preventDefault();
    state.q = $q.value;
    state.ano = $ano.value;
    state.tipo = $tipo.value;
    state.sort = $sort.value;
    apply();
  });
  $clear.addEventListener('click', ()=>{
    $q.value = ''; $ano.value = ''; $tipo.value = ''; $sort.value = 'data_desc';
    state.q = ''; state.ano = ''; state.tipo = ''; state.sort = 'data_desc';
    apply();
  });
  $prev.addEventListener('click', ()=>{ if (state.page>1) { state.page--; render(); } });
  $next.addEventListener('click', ()=>{
    const max = Math.ceil(state.view.length / state.perPage);
    if (state.page < max) { state.page++; render(); }
  });

  // Primeira carga
  apply();
})();
</script>
